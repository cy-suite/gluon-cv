DDP_CONFIG:
  WORLD_SIZE: 1
  WORLD_RANK: 0
  GPU_WORLD_SIZE: 8
  GPU_WORLD_RANK: 0
  DIST_URL: 'tcp://172.31.72.252:23456'
  WOLRD_URLS: ['172.31.72.252']
  AUTO_RANK_MATCH: True
  DIST_BACKEND: 'nccl'
  GPU: 0
  DISTRIBUTED: True

CONFIG:
  DATA:
    KEYPOINT_ON: True
    DATASET:
      TRAIN: ("keypoints_coco_2017_train",)
      TEST: ("keypoints_coco_2017_val",)
  MODEL:
    PROPOSAL_GENERATOR:
      NAME: "DIRECTPOSE"
    DIRECTPOSE:
  #    TOP_LEVELS: 0
  #    SIZES_OF_INTEREST: [64, 128]
  #    FPN_STRIDES: [8, 16, 32]
  #    IN_FEATURES: ['p3', 'p4', 'p5']
      TOP_LEVELS: 2
      SIZES_OF_INTEREST: [64, 128, 256, 512]
      FPN_STRIDES: [8, 16, 32, 64, 128]
      IN_FEATURES: ['p3', 'p4', 'p5', 'p6', 'p7']
  SOLVER:
    IMS_PER_BATCH: 16
    BASE_LR: 0.01  # Note that RetinaNet uses a different default learning rate
    STEPS: (60000, 80000)
    MAX_ITER: 90000
    CHECKPOINT_PERIOD: 30000
  INPUT:
    MIN_SIZE_TRAIN: (640, 672, 704, 736, 768, 800)
  INPUT:
    MIN_SIZE_RANGE_TRAIN: (480, 1600)
    MIN_SIZE_TRAIN: (800,)
    MAX_SIZE_TRAIN: 2666
    MAX_SIZE_TEST: 1333
    MIN_SIZE_TEST: 800
    CROP:
      ENABLED: True
      TYPE: "absolute"
      SIZE: [800, 800]
  MODEL:
    WEIGHTS: "http://dl.yf.io/dla/models/imagenet/dla34-ba72cf86.pth"
    DLA:
      CONV_BODY: "DLA34"
      NORM: "SyncBN"
    FPN:
      IN_FEATURES: ["level3", "level4", "level5"]
    DIRECTPOSE:
      ENABLE_HM_BRANCH: False   # Enable it during training and disable it during testing
      HM_OFFSET: False
      HM_TYPE: 'BinaryLabels'
      HM_LOSS_WEIGHT: 4.0
      REFINE_KPT: False
      SAMPLE_FEATURE: 'lower'
      KPALIGN_GROUPS: 9
      SEPERATE_CONV_FEATURE: True
      LOSS_ON_LOCATOR: False
      KPT_VIS: True
      CLOSEKPT_NMS: False
      CENTER_BRANCH: 'kpt'
      USE_SCALE: False
  SOLVER:
    IMS_PER_BATCH: 32
    STEPS: (60000, 80000)
    MAX_ITER: 180000
    CHECKPOINT_PERIOD: 60000
    LR_SCHEDULER_NAME: "WarmupLinearLR"    # ("WarmupLinearLR", "WarmupCosineLR", "WarmupMultiStepLR")
  TEST:
    EVAL_PERIOD: 10000
  OUTPUT_DIR: "output/directpose/DIRECTPOSE_RT_MS_DLA_34_4x_syncbn_3FPN_debug"
